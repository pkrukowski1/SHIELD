method: grid
metric:
  name: avg_acc
  goal: maximize

parameters:

  dataset:
    value: split_cifar_100
  method:
    value: shield
  model:
    value: alexnet
  exp:
    value: adversarial_attack

  # Dataset (fixed)
  dataset._target_:
    value: continual_dataset.SplitCIFAR100
  dataset.number_of_tasks:
    value: 10
  dataset.validation_size:
    value: 500
  dataset.use_augmentation: 
    value: False
  dataset.use_cutout: 
    value: False
  
  # Experiment setup
  exp.seed:
    value: 42
  exp.epsilon:
    value: 0.00784313725

  exp.attack.auto_attack._target_:
    value: attack.AutoAttack
  exp.attack.auto_attack.eps:
    value: 0.007843137254
  exp.attack.auto_attack.total_no_classes:
    value: 100
  exp.attack.auto_attack.input_shape:
    value: [3, 32, 32]

  exp.path_to_weights: 
    value: ./saved_models/split_cifar_100/hnet/42

  # Fabric setup
  fabric.accelerator:
    value: gpu

  # Model
  model._target_:
    value: model.HyperNetWithAlexNet
  model.no_classes_per_task:
    value: 10
  model.activation_function._target_:
    value: torch.nn.ReLU
  model.hnet_hidden_layers:
    value: [100, 50]
  model.hnet_embedding_size:
    value: 512


  # W&B logging
  wandb.entity:
    value: ${oc.env:WANDB_ENTITY}
  wandb.project:
    value: ${oc.env:WANDB_PROJECT}

command:
  - ${env}
  - python
  - src/main.py
  - --config-name
  - shield.yaml
  - ${args_no_hyphens}
